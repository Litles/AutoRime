# AutoRime
Rime 打字模拟和数据统计

## 使用方法

1. 将需要测试的某方案的相关文件（`dict.yaml`、`schema.yaml`等）拷贝到 Rime 文件夹内；
2. （**重要**）将准备的 `mapping_table.txt`文件（形码类方案）/ `dict_yamls`文件夹（音码类方案），拷贝到`auto_rime`文件夹内；
3. 将该方案设为首选方案：编辑`default.custom.yaml`，取消`- {schema: myschema}`那行的注释（将`myschema`改为实际方案的名称）；
4. 部署该方案：双击执行`build.bat`；
5. （**重要**）测试该方案是否部署成功且有效：双击执行`test.bat`，输入编码会返回候选，并显示当前输入法状态（确认是你的输入法，而不默认的“拼音简体”），输入`1`可以上屏首选，输入`exit`可退出；
6. 上一步确认没问题后，就可以开始进行打字模拟了：双击运行`AutoRime.exe`即可。

## 关于形码类方案的模拟

（**重要**）形码类方案的模拟需要提供`mapping_table.txt`文件，该文件的格式类似于单字码表，规定了模拟跟打程序碰到相应的字时，应该对应输入什么编码，因此要求一字一个唯一码（不能一字多码），示例格式如下：

<img src="https://github.com/Litles/AutoRime/blob/main/images/mapping_table_01.png" width="250"/> <img src="https://github.com/Litles/AutoRime/blob/main/images/mapping_table_02.png" width="250"/>

## 关于音码类方案的模拟

（**重要**）对于拼音类方案的模拟，如果按上面形码的方法一字一码进行模拟输入的话，比较机械、无法分辨多音字；这对于拼音类的方案可能不利，所以测出的准确率可能会偏低一点，因此最好按程序中的“拼音类”的跟打选项来进行模拟，该选项需要提供`dict_yamls`文件夹：

* `dict_yamls`文件夹中放置了待测方案的全部相关`dict.yaml`文件（只放待测方案的，除此之外不要放无关的文件）；

程序会自动扫描该文件夹中的`dict.yaml`文件，从中提取生成`mapping_table.txt`和`mapping_table_sup.txt`，用于音码方案的跟打模拟。

> 由于程序会自动生成，因而也就不需要像上面的形码方案般自己提供`mapping_table.txt`了

## 补充说明

+ （**重要**）`auto_rime`文件夹内的所有文本文件一律要求是 UTF-8 无签名编码格式（Windows下的CRTF换行符）；
+ `unmatched_lines`文件夹里有错字结果，可以供参考核实；
+ 如果想扩大样本量，可以往`articles`文件夹多放 txt 文本文件（文章排版随意，程序会自动处理，但单个文件不要太大），会自动识别；
+ 对于方案的模拟测试，一般不建议方案开启用户词库（亦即自动调频），不然每次测试的结果可能不一样

## 相关测试记录

| 输入法方案 | 方案类型 | 使用词库 | 词库大小 | 识别多音字 | 跟打语料 | 语料句数/字数 | 完全准确率 | 综合准确率 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 三码整句（卿云） | 形码 | 白霜词库 | 60万 | - | 《人民日报》2003年12月刊文 | 29万/260万| 97.00%| 99.60%|
| 三码整句（小鹤加卿云首根） | 音形码 | 白霜词库 | 60万 | 是 | 《人民日报》2003年12月刊文 | 29万/260万| 91.54%| 98.89%|
| 简体全拼 | 音码 | 峰芸词库 | 370万 | 是 | 《人民日报》2003年12月刊文 | 29万/260万| 58.02%| 88.35%|
| 简体全拼 | 音码 | 简约词库 | 25万 | 是 | 《人民日报》2003年12月刊文 | 29万/260万| 52.13%| 85.83%|

> 注：语料中句子指的是短句（即句中无标点符号），一个短句最少两个字；`完全准确率 = 正确句数 / 全部句数 * 100%`，`综合准确率 = 正确字数 / 全部字数 * 100%`


## 参考

+ https://github.com/rime/librime
+ https://github.com/hanzi-chai/sentence
